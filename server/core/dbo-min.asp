<%define(function(d,c,e){var b=function(f){this.object=f};function a(g,l){var f=g.length/l,n=[],m;for(var k=0;k<f;k++){n[k]=new Array();m=k*l;for(var h=0;h<l;h++){n[k][h]=g[m+h]}}return n}b.prototype.each=function(g){var f=0;this.object.MoveFirst();while(!this.object.Eof){g.call(this.object,f);this.object.MoveNext();++f}};b.prototype.getRows=function(){var f=[];try{f=this.object.GetRows().toArray()}catch(g){}return a(f,this.object.Fields.Count)};b.prototype.serverPage=function(g,f,n){var l=this.object,k=0;var m=l.RecordCount;if(f>m){f=m}var h=Math.ceil(m/f);if(h<0){h=0}if(g>h){g=h}if(g<1){g=1}l.PageSize=f;l.AbsolutePage=g;if(typeof n==="function"){while(!l.Eof&&k<f){var j=n.call(l,k);if(j===undefined){j=true}if(j===false){break}else{k++;l.MoveNext()}}}return[m,f,g,h]};c.add=function(g){if(g===undefined){g={}}if(g.rs===undefined){g.rs=this.createRecordSet()}try{g.rs.Open("Select * From "+g.table,g.conn,3,2);g.rs.AddNew();for(var f in g.data){g.rs(f)=g.data[f]}g.rs.Update();(typeof g.callback==="function")&&g.callback.call(g.rs);g.rs.Close()}catch(h){console.push(h.message)}return this};c.update=function(g){if(g===undefined){g={}}if(g.rs===undefined){g.rs=this.createRecordSet()}try{g.rs.Open("Select * From "+g.table+" Where "+g.key+"="+g.keyValue,g.conn,3,3);for(var f in g.data){g.rs(f)=g.data[f]}g.rs.Update();(typeof g.callback==="function")&&g.callback.call(g.rs);g.rs.Close()}catch(h){console.push(h.message)}return this};c.destory=function(g){if(g===undefined){g={}}if(g.rs===undefined){g.rs=this.createRecordSet()}try{for(var f in g.data){g.rs.Open("Select * From "+g.table+" Where "+f+"="+g.data[f],g.conn,3,3);g.rs.Delete();g.Close()}}catch(h){console.push(h.message)}return this};c.trave=function(g){if(g===undefined){g={}}if(g.rs===undefined){g.rs=this.createRecordSet()}if(g.type===undefined){g.type=1}var f;try{if(g.callback===undefined){f=g.conn.Execute(g.sql)}else{g.rs.Open(g.sql,g.conn,3,g.type);f=g.callback.call(new b(g.rs),g.rs,g.conn);g.rs.Close()}}catch(h){console.push(h.message)}return f};c.createRecordSet=function(){return new ActiveXObject(config.nameSpace.record)}});%>