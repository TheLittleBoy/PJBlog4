<%@LANGUAGE="JAVASCRIPT" CODEPAGE="65001"%>
<%
var config={};var console={},selector,fetch,include,define,require,exports={},module,map={},asa,http;var JSON=!JSON?{}:JSON;(function(b,a){if(b.indexOf===undefined){b.indexOf=function(e){var d=-1;for(var c=0;c<this.length;c++){if(this[c]===e){d=c;break}}return d}}if(a.trim===undefined){a.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}}if(b.forEach===undefined){b.forEach=function(e){for(var d=0,c=this.length;d<c;d++){e.call(this,this[d],d)}}}})(Array.prototype,String.prototype);(function(){config.debug=false;config.useApp=true;config.appName="obay";config.location=Server.MapPath(".");config.rootion=Server.MapPath("/");config.base=(function(){var e=config.location.replace(new RegExp("^"+config.rootion.replace(/\\/g,"\\\\")),"").substring(1).split("\\").length;var c="";for(var d=0;d<e;d++){c+="../"}return c})();var b=".";config.nameSpace={conn:"ADODB"+b+"CONNECTION",record:"ADODB"+b+"RECORDSET",fso:"Scripting"+b+"FileSystemObject",stream:"Adodb"+b+"Stream",xmlhttp:"Microsoft"+b+"XMLHTTP",xml:"Microsoft"+b+"XMLDOM",winhttp:"WinHttp"+b+"WinHttpRequest.5.1"};config.charset="utf-8";console.log=function(c){Response.Write(c)};console.end=function(c){this.log(c);Response.End()};var a=[];console.push=function(c){a.push(c)};console.debug=function(){if(config.debug&&(a.length>0)){var c="";for(var d=0;d<a.length;d++){c+="<li>"+a[d]+"</li>"}c='<ol class="debug">'+c+"</ol>";this.end(c)}}})();(function(){selector=function(c,a){if(map[c]!==undefined){c=map[c]}var b="";if(config.base===undefined){config.base="/"}else{if(!/^\//.test(config.base)){config.base="/"+config.base}}if(/^\.\//.test(c)){b=config.location+"\\"+c.replace(/^\.\//,"").replace(/\//g,"\\")}else{if(/^\.\.\//.test(c)){b=(function(){var f=(config.location+"/"+c).replace(/\\/g,"/"),e=f.split("/"),h=config.rootion,i=h.replace(/\\/g,"/").split("/"),d=i.length-1;var g=function(){var j=e.indexOf("..");if(j-1>d){e.splice(j-1,2);return g()}else{return e}};return g().join("\\")})()}else{if(/^\//.test(c)){b=config.rootion+c.replace(/\//g,"\\")}else{b=Server.MapPath((config.base==="/"?"":config.base)+"/"+c)}}}if(!a){b=!/\.asp$/.test(b)?b+".asp":b}return b};selector.lock=function(a){return selector(a,true)}})();(function(){var regExpress={includeExp:/\<\!\-\-\#include\sfile\s?\=\s?\"(.+?)\"\s?\-\->/g,includeFileExp:/file\=\"(.+)\"/,includeContentForLeftExp:/^[\r\t\s\n]+/,includeContentForRightExp:/[\r\t\s\n]+$/};function ReadFileContainer(id){var o=new ActiveXObject(config.nameSpace.stream),Text;o.Type=2;o.Mode=3;o.Open();o.Charset=config.charset;o.Position=o.Size;o.LoadFromFile(id);Text=o.ReadText;o.Close;o=undefined;return reLoadContainerFileRelative(Text,id.split("\\").slice(0,-1).join("\\"))}function reLoadContainerFileRelative(context,localFo){var l=0,text="",r=0,p="",e,t,tempText;if(regExpress.includeExp.test(context)){while(l>-1){l=context.indexOf("<!--#include");if(l>-1){text+=context.substring(0,l);context=context.substring(l+12);r=context.indexOf("-->");p=context.substring(0,r);e=p.replace(/file\s?\=\s?\"/,"").replace(/\"/,"").trim();if(localFo.length==0){t=e}else{t=localFo+"\\"+e}context=context.substring(r+3);tempText=ReadFileContainer(t);text+=reLoadContainerFileRelative(tempText,t.split("\\").slice(0,-1).join("\\"))}else{text+=context;context=""}}return text}else{return context}}function GrepSytax(context){context=context.replace(regExpress.includeContentForLeftExp,"").replace(regExpress.includeContentForRightExp,"");function textformat(t){if(t.length>0){return';Response.Write("'+t.replace(/\\/g,"\\\\").replace(/\"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\s/g," ").replace(/\t/g,"\\t")+'");'}else{return""}}var blank="",conSplit=context.split("<"+blank+"%"),r=0,text="",temp;for(var i=0;i<conSplit.length;i++){r=conSplit[i].indexOf("%"+blank+">");if(r>-1){temp=textformat(conSplit[i].substring(r+2));text+=(/^\=/.test(conSplit[i])?";Response.Write("+conSplit[i].substring(1,r)+");":conSplit[i].substring(0,r))+temp}else{text+=textformat(conSplit[i])}}return text}fetch=function(pathMark){return GrepSytax(ReadFileContainer(selector(pathMark)))};include=function(pathMark){eval(fetch(pathMark))}})();(function(){module=function(c,b,a){this.id=c;this.deps=b||[];this.factory=a;this.exports={}}})();(function(){function a(f){var g=/(?:^|[^.])\brequire\s*\(\s*(["'])([^"'\s\)]+)\1\s*\)/g;var e=[],d;f=b(f);while((d=g.exec(f))){if(d[2]){e.push(d[2])}}return c(e)}function b(d){return d.replace(/(?:^|\n|\r)\s*\/\*[\s\S]*?\*\/\s*(?:\r|\n|$)/g,"\n").replace(/(?:^|\n|\r)\s*\/\/.*(?:\r|\n|$)/g,"\n")}var c=function(d){var e=[],g={};d.forEach(function(h){g[h]=1});if(Object.keys){e=Object.keys(g)}else{for(var f in g){if(g.hasOwnProperty(f)){e.push(f)}}}return e};define=function(f,d){if(d===undefined){d=f;f=[]}if(typeof f==="string"){f=[f]}if(typeof d==="function"){var e=a(d.toString());f=f.concat(e)}exports[config.current]=new module(config.current,f,d)}})();(function(){var a=function(e,d){this.deps=e;this.fn=d;this.ret=[]};var c=function(d){this.rootUri=d};a.prototype.run=function(){for(var e=0;e<this.deps.length;e++){var d=new c(this.deps[e]);this.ret.push(d.get())}};c.prototype.get=function(){var d=selector(this.rootUri);if(exports[d]===undefined){config.current=d;include(this.rootUri);config.current=undefined;console.push("loader : "+d);if(exports[d]===undefined){exports[d]=new module(d,[],function(){})}else{var g=exports[d],e=g.deps;b(e)}}var h=exports[d];var f=h.factory(b,h.exports,h);if(f===undefined){return h.exports}else{return f}};var b=function(f,e){if(typeof f==="string"){f=[f]}var d=new a(f,e);d.run();if(typeof e==="function"){e.apply(null,d.ret)}else{if(d.ret.length>0){if(d.ret.length===1){return d.ret[0]}else{return d.ret}}}};require=b;require.async=b})();(function(){var a=function(b,e){var d=new Enumerator(b),c=[];for(;!d.atEnd();d.moveNext()){if(typeof e==="function"){c.push(e.call(d,d.item()))}else{c.push(d.item())}}return c};http=function(h){var c={query:{},form:{}},d=0,f,b;var e=a(Request.QueryString);var g=a(Request.Form);for(d=0;d<e.length;d++){f=a(Request.QueryString(e[d]));c.query[e[d]]=(f.length===1?f[0]:f)}for(d=0;d<g.length;d++){f=a(Request.Form(g[d]));c.form[g[d]]=(f.length===1?f[0]:f)}b=h(c);return b};http.async=function(d){var b=http(d);try{console.log(JSON.stringify(b))}catch(c){console.end(c.message)}};http.write=function(d){var b=http(d);try{console.log(b.toString())}catch(c){console.end(c.message)}}})();(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());(function(){asa=function(){var b="/global.asa",c=new ActiveXObject(config.nameSpace.fso),a='<object id="'+(config.appName||"obay")+'" runat="server" scope="Application" progid="Scripting.Dictionary"></object>\n<script language="JScript" runat="Server">\nfunction Session_OnStart(){};\nfunction Session_OnEnd(){};\nfunction Application_OnStart(){};\nfunction Application_OnEnd(){};\n<\/script>';if(config.useApp&&!c.FileExists(Server.MapPath(b))){var d=new ActiveXObject(config.nameSpace.stream);d.Type=2;d.Mode=3;d.Open();d.Charset=config.charset;d.Position=d.Size;d.WriteText=a;d.SaveToFile(Server.MapPath(b),2);d.Close;d=null}c=null}})();%>