<%define(function(b,a,c){a.createFSO=function(){return new ActiveXObject(config.nameSpace.fso)};a.auto=function(e,d){if(d===undefined){d=this.createFSO()}return e.call(d)};a.exsit=function(f,e,d){return this.auto(function(){if(e===undefined){e===false}if(e===true){return this.FolderExists(selector.lock(f))}else{return this.FileExists(selector.lock(f))}},d)};a.create=function(e,f,d){return this.auto(function(){try{if(f===true){e=selector.lock(e);console.push(e);var h=/(\w)\:\\(.+)/.exec(e);console.push(h);if(h){var l=h[2];var k=h[1];var g=l.split("\\");k=k+":";for(var j=0;j<g.length;j++){if(g[j].length>0){k=k+"\\"+g[j];if(!this.FolderExists(k)){this.CreateFolder(k)}}else{break}}}else{return false}}else{this.CreateFolder(selector.lock(e))}return true}catch(m){console.push(m.message);return false}},d)};a.collect=function(f,e,g,d){return this.auto(function(){var i=this.GetFolder(selector.lock(f)),l=null;if(e===undefined){e=false}if(e===true){l=i.SubFolders}else{l=i.Files}var k=new Enumerator(l),h=[];for(;!k.atEnd();k.moveNext()){var j=k.item().Name;if(typeof g==="function"){j=g(j);if(j!==null){h.push(j)}}else{h.push(j)}}return h},d)};a.destory=function(f,e,d){var g=this;return this.auto(function(){if(e===undefined){e=false}if(e===true){this.DeleteFolder(selector.lock(f))}else{this.DeleteFile(selector.lock(f))}return !g.exsit(f,e,this)},d)};a.destorys=function(h,g,e){h=h.replace(/\/$/,"");if(g===undefined){g="all"}var j=this,f,d;return this.auto(function(){if(g==="file"){d=j.collect(h,false,function(i){return h+"/"+i},this);for(f=0;f<d.length;f++){j.destory(d[f],false,this)}}else{if(g==="folder"){d=j.collect(h,true,function(i){return h+"/"+i},this);for(f=0;f<d.length;f++){j.destory(d[f],true,this)}}else{j.destorys(h,"file",this);j.destorys(h,"folder",this)}}},e)};a.move=function(g,h,f,d,e){var i=g.split("/").slice(-1).join("");if(typeof d==="function"){i=d(i)}else{if(typeof d==="string"){i=d}}return this.auto(function(){try{if(f===undefined){f=false}if(f===true){this.MoveFolder(selector.lock(g),selector.lock(h)+"\\"+i)}else{this.MoveFile(selector.lock(g),selector.lock(h)+"\\"+i)}return true}catch(j){return false;console.push(j.message)}},e)};a.moves=function(f,g,e,d){var h=this;return this.auto(function(){var j,k;if(e==="file"){j=h.collect(f,false,function(i){return f+"/"+i},this);for(k=0;k<j.length;k++){h.move(j[k],g,false,null,this)}}else{if(e==="folder"){j=h.collect(f,true,function(i){return f+"/"+i},this);for(k=0;k<j.length;k++){h.move(j[k],g,true,null,this)}}else{h.moves(f,g,"file",e,this);h.moves(f,g,"folder",e,this)}}},d)};a.copy=function(g,h,f,d,e){var i=g.split("/").slice(-1).join("");if(typeof d==="function"){i=d(i)}else{if(typeof d==="string"){i=d}}return this.auto(function(){try{if(f===undefined){f=false}if(f===true){this.CopyFolder(selector.lock(g),selector.lock(h)+"\\"+i)}else{this.CopyFile(selector.lock(g),selector.lock(h)+"\\"+i)}return true}catch(j){return false;console.push(j.message)}},e)};a.copys=function(f,g,e,d){var h=this;return this.auto(function(){var j,k;if(e==="file"){j=h.collect(f,false,function(i){return f+"/"+i},this);for(k=0;k<j.length;k++){h.copy(j[k],g,false,null,this)}}else{if(e==="folder"){j=h.collect(f,true,function(i){return f+"/"+i},this);for(k=0;k<j.length;k++){h.copy(j[k],g,true,null,this)}}else{h.copys(f,g,"file",e,this);h.copys(f,g,"folder",e,this)}}},d)};a.rename=function(g,e,f,d){return this.auto(function(){try{var i=null;if(f===undefined){f=false}if(f===true){i=this.GetFolder(selector.lock(g))}else{i=this.GetFile(selector.lock(g))}i.Name=e;return true}catch(h){console.push(h.message);return false}},d)};a.getAllFolders=function(g,e){var d=this.collect(g,true,function(h){if(/^\./.test(h)){return null}else{return g==="/"?"/"+h:g+"/"+h}},e);for(var f=0;f<d.length;f++){d=d.concat(this.getAllFolders(d[f],e))}return d};a.collects=function(e,d){var f=this;return this.auto(function(){return f.getAllFolders(e)},d)}});%>