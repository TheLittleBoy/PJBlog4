<%define(function(c,a,d){var b=c("XML"),e=c("FSO"),f=c("STREAM");a.merge=function(h,u,s){var m=e.createFSO(),v=(function(){var x;try{x=new ActiveXObject("Microsoft.XMLDOM")}catch(i){x=new ActiveXObject("Msxml2.DOMDocument.5.0")}return x})(),q=e.collects(h,m),t=(function(){var y=[];for(var x=0;x<q.length;x++){y=y.concat(e.collect(q[x],false,function(i){if(/^\./.test(i)){return null}else{return w==="/"?"/"+i:q[x]+"/"+i}},m))}y=y.concat(e.collect(h,false,function(i){if(/^\./.test(i)){return null}else{return w==="/"?"/"+i:h+"/"+i}},m));return y})(),k='<?xml version="1.0"?><package xmlns:dt="urn:schemas-microsoft-com:datatypes"><list><folders></folders><files></files></list></package>',r=b.load(k);if(r!==null){var n=b("list",r.root,r.object).attr({folders:q.length,files:t.length}),j=n.find("folders"),g=n.find("files"),l=0,w,p;function o(x){var i=v.createElement("file"),y=f.load(x,true);i.dataType="bin.base64";i.nodeTypedValue=y;return i.text}for(l=0;l<q.length;l++){w=q[l];if(typeof s==="function"){w=s(w)}j.create("item").html(w)}for(l=0;l<t.length;l++){w=t[l];p=w;if(typeof s==="function"){w=s(w)}g.create("item").attr("path",w).html(o(p))}n.save(u)}else{console.push(k+" 打开失败")}};a.separate=function(k,i,n){var m=b.load(k),o=(function(){var q;try{q=new ActiveXObject("Microsoft.XMLDOM")}catch(p){q=new ActiveXObject("Msxml2.DOMDocument.5.0")}return q})();if(m!==null){var l=b("list",m.root,m.object),j=l.find("folders item"),g=l.find("files item");function h(p){var q=o.createElement("file");q.dataType="bin.base64";q.text=p;return q.nodeTypedValue}j.each(function(){var p=b("",this,l.object),q=(i==="/"?"/":i+"/")+p.html();if(typeof n==="function"){n(q)}e.create(q)});g.each(function(){var q=b("",this,l.object),p=q.html(),r=(i==="/"?"/":i+"/")+q.attr("path"),s=h(p);if(typeof n==="function"){n(r)}f.save(s,r,true)})}else{console.push(packageXml+" 打开失败")}}});%>