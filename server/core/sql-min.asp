<%define(function(d,c,e){var b=function(f){return new b.init(f)};function a(f){if(typeof f!=="string"){return f}else{return"'"+f+"'"}}b.init=function(f){this.object=f;this.table=null};b.init.prototype={createTable:function(f){this.resetError(function(){this.object.Execute("CREATE TABLE "+f);this.table=f});return this},getTable:function(f){this.table=f;return this},extend:function(g,h){if(h===undefined){h={}}for(var f in h){g[f]=h[f]}return g},createParam:function(g,h,i,f){f=this.extend({autoAdd:false,primary:false,defaults:""},f||{});this.resetError(function(){if(typeof h==="object"){f=h;h="";i=""}var j="ALTER TABLE "+this.table+" ADD COLUMN "+g;if(h.length>0){j+=" "+h;if(i.length>0){j+="("+i+")"}}if(f.defaults.length>0){j+=" default "+f.defaults}if(f.autoAdd===true){j+=" COUNTER(1, 1)"}if(f.primary===true){j+=" PRIMARY KEY"}this.object.Execute(j)});return this},createParams:function(g){for(var f in g){this.createParam(f,g[f].type||"",g[f].value||"",g[f])}return this},add:function(f){this.resetError(function(){var h="INSERT INTO "+this.table+" ($key) VALUES ($keyValue)",i=[],j=[];for(var g in f){i.push(g);j.push(a(f[g]))}h=h.replace("$key",i.join(", ")).replace("$keyValue",j.join(", "));this.object.Execute(h)});return this},update:function(f,g){this.resetError(function(){var n=[],m="UPDATE "+this.table+" SET $setValue",l="UPDATE "+this.table+" SET $setValue WHERE $condition",j,o=[];for(var h in f){n.push(h+" = "+a(f[h]))}if(g!==undefined){for(var k in g){o.push(k+" = "+a(g[k]))}if(o.length>0){j=l}else{j=m}}else{j=m}j=j.replace("$setValue",n.join(", ")).replace("$condition",o.join(" AND "));this.object.Execute(j)});return this},destory:function(f){this.resetError(function(){var l=[],k="DELETE FROM "+this.table,j="DELETE FROM "+this.table+" WHERE $condition",g;if(f!==undefined){for(var h in f){l.push(h+" = "+a(f[h]))}if(l.length>0){g=j}else{g=k}}else{g=k}g=g.replace("$condition",l.join(" AND "));this.object.Execute(g)});return this},resetError:function(g){try{g.call(this)}catch(f){console.push(f.message)}}};return b});%>